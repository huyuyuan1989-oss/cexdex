<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”— V8 å…¨éˆè³‡é‡‘æµå‘æˆ°æƒ…å®¤ | Sovereign Terminal</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+TC:wght@400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            /* Financial Terminal Theme (Slate-900 base) */
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --bg-header: #334155;
            --border: #475569;

            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-accent: #00ffcc;
            /* Neon Cyan from Monitor */

            /* High Contrast Financial Colors */
            --bullish: #22c55e;
            --bullish-bg: rgba(34, 197, 94, 0.15);
            --bearish: #ef4444;
            --bearish-bg: rgba(239, 68, 68, 0.15);
            --neutral: #fbbf24;
            --neutral-bg: rgba(251, 191, 36, 0.15);

            --accent: #6366f1;

            /* Monitor Specifics */
            --badge-whale-bg: rgba(255, 215, 0, 0.15);
            --badge-whale-text: #ffd700;
            --badge-smart-bg: rgba(180, 80, 255, 0.15);
            --badge-smart-text: #b450ff;
            --badge-inst-bg: rgba(0, 150, 255, 0.15);
            --badge-inst-text: #0096ff;

            --alert-border: #ff3333;
        }

        /* Pulse Animation */
        @keyframes pulse-red {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.4);
            }

            70% {
                box-shadow: 0 0 0 6px rgba(255, 51, 51, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(255, 51, 51, 0);
            }
        }

        /* Badge Styles */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid transparent;
        }

        .badge-whale {
            background: var(--badge-whale-bg);
            color: var(--badge-whale-text);
            border-color: rgba(255, 215, 0, 0.3);
        }

        .badge-smart {
            background: var(--badge-smart-bg);
            color: var(--badge-smart-text);
            border-color: rgba(180, 80, 255, 0.3);
        }

        /* Tab Navigation Styles */
        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0;
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            font-weight: 600;
        }

        .nav-tab:hover {
            color: var(--text-primary);
        }

        .nav-tab.active {
            color: var(--text-accent);
            border-bottom-color: var(--text-accent);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 1.5rem;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Mobile Responsiveness - Card View Transformation */
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .container {
                padding: 0;
            }

            h1 {
                font-size: 1.5rem !important;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            /* HIDE TABLE HEADERS */
            thead {
                display: none;
            }

            /* TRANSFORM TABLE TO CARDS */
            table,
            tbody,
            tr,
            td {
                display: block;
                width: 100%;
            }

            .table-container {
                background: transparent;
                border: none;
                box-shadow: none;
                overflow: visible;
            }

            /* Card Style for Rows */
            tr {
                margin-bottom: 1rem;
                background: var(--bg-card);
                border: 1px solid var(--border);
                border-radius: 12px;
                padding: 1rem;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            }

            /* Cell Styling */
            td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                text-align: right;
                padding: 0.75rem 0;
                /* More padding */
                border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
                position: relative;
                /* For tooltips */
            }

            td:last-child {
                border-bottom: none;
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                margin-top: 0.5rem;
                padding-top: 1rem;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            /* ROBUST LABEL DISPLAY using data-label attribute */
            td::before {
                content: attr(data-label);
                float: left;
                font-weight: 500;
                color: var(--text-secondary);
                text-transform: uppercase;
                font-size: 0.85rem;
                letter-spacing: 0.5px;
                max-width: 60%;
                /* Prevent overlap */
                text-align: left;
            }

            /* First Cell (Name) Header Style */
            td:first-child {
                justify-content: flex-start;
                font-size: 1.25rem;
                font-weight: 700;
                color: var(--text-primary);
                border-bottom: 2px solid var(--border);
                padding-bottom: 0.75rem;
                margin-bottom: 0.5rem;
            }

            td:first-child::before {
                display: none;
            }

            /* Hide label for Name row */

            .weather-banner {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }

            .btn-group {
                flex-direction: column;
                width: 100%;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* 4. MOBILE RESPONSIVENESS (Card Transformation) */
        @media screen and (max-width: 768px) {

            /* Force table to block layout using specificity */
            .market-table,
            .market-table thead,
            .market-table tbody,
            .market-table th,
            .market-table td,
            .market-table tr {
                display: block;
                width: 100%;
            }

            /* Hide Desktop Headers */
            .market-table thead {
                display: none;
            }

            /* Card Style for Rows */
            .market-table tr {
                margin-bottom: 1.5rem;
                background-color: var(--bg-card);
                border: 1px solid var(--border);
                border-radius: 12px;
                padding: 1.25rem;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            }

            /* Outlier Styling on Cards */
            .market-table tr.outlier-high-vol {
                border-color: var(--outlier-red-border);
                background: linear-gradient(145deg, var(--bg-card), rgba(239, 68, 68, 0.1));
            }

            /* Cell Flexbox Layout */
            .market-table td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                text-align: right;
                padding: 0.75rem 0;
                border-bottom: 1px dashed #334155;
            }

            .market-table td:last-child {
                border-bottom: none;
                flex-direction: row;
                /* Keep Signal horizontal on mobile */
                margin-top: 0;
            }

            /* ADVANCED LABELING: content from data-label */
            .market-table td::before {
                content: attr(data-label);
                float: left;
                font-weight: 700;
                color: var(--text-secondary);
                text-transform: uppercase;
                font-size: 0.8rem;
                letter-spacing: 0.5px;
            }

            /* Specific styling for Asset Name (First Child) */
            .market-table td:first-child {
                font-size: 1.2rem;
                font-weight: 700;
                color: var(--text-primary);
                justify-content: flex-start;
                border-bottom: 2px solid var(--border);
                margin-bottom: 0.5rem;
                padding-bottom: 0.75rem;
            }

            .market-table td:first-child::before {
                display: none;
            }

            /* Hide "Asset" label */
        }

        /* Typography */
        h1,
        h2,
        h3 {
            font-family: 'Noto Sans TC', sans-serif;
            font-weight: 700;
            color: var(--text-primary);
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* 2. AI Market Weather Banner */
        .weather-banner {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid transparent;
            font-weight: 500;
        }

        .weather-bullish {
            background: rgba(34, 197, 94, 0.1);
            border-color: var(--bullish);
            color: #4ade80;
        }

        .weather-bearish {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--bearish);
            color: #f87171;
        }

        .weather-neutral {
            background: rgba(251, 191, 36, 0.1);
            border-color: var(--neutral);
            color: var(--neutral);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 1.25rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
        }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Colors */
        .text-green {
            color: var(--bullish);
        }

        .text-red {
            color: var(--bearish);
        }

        .text-neutral {
            color: var(--text-secondary);
        }

        /* 3. Interactive Tables */
        .section {
            margin-bottom: 2.5rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 1rem;
        }

        .table-container {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th {
            background: var(--bg-header);
            padding: 1rem;
            text-align: right;
            font-weight: 600;
            color: var(--text-secondary);
            user-select: none;
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
        }

        th:first-child {
            text-align: left;
        }

        td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-family: 'JetBrains Mono', monospace;
        }

        td:first-child {
            text-align: left;
            font-family: 'Noto Sans TC', sans-serif;
            font-weight: 500;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        tr:last-child td {
            border-bottom: none;
        }

        /* Sorting Header */
        .sortable {
            cursor: pointer;
            transition: color 0.2s;
        }

        .sortable:hover {
            color: var(--text-primary);
        }

        .sort-icon {
            font-size: 0.7em;
            margin-left: 4px;
            opacity: 0.5;
        }

        .sortable.active {
            color: var(--accent);
        }

        .sortable.active .sort-icon {
            opacity: 1;
        }

        /* Tooltips */
        .has-tooltip {
            position: relative;
            border-bottom: 1px dotted var(--text-secondary);
        }

        .has-tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background: #000;
            color: #fff;
            padding: 0.5rem 0.8rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 400;
            white-space: pre-wrap;
            width: max-content;
            max-width: 250px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            z-index: 10;
            border: 1px solid var(--border);
            text-align: center;
        }

        /* Tags */
        .tag {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 0.5rem;
            font-family: 'Noto Sans TC', sans-serif;
            font-weight: 500;
        }

        .tag-bullish {
            background: var(--bullish-bg);
            color: var(--bullish);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .tag-bearish {
            background: var(--bearish-bg);
            color: var(--bearish);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .tag-neutral {
            background: var(--neutral-bg);
            color: var(--neutral);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        /* 5. Quant Zone */
        .quant-zone {
            background: linear-gradient(180deg, var(--bg-card) 0%, rgba(30, 41, 59, 0.5) 100%);
            border: 1px dashed var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-top: 3rem;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            background: var(--bg-header);
            color: var(--text-primary);
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--border);
            border-color: var(--text-secondary);
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--accent);
            border-color: var(--accent);
        }

        .btn-primary:hover {
            background: #4f46e5;
            border-color: #4f46e5;
        }

        /* 6. Methodology Footer */
        .footer {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .method-box {
            background: rgba(255, 255, 255, 0.02);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .method-item h4 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .loading {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
    </style>
    <title>ğŸ”— V8 å…¨éˆè³‡é‡‘æµå‘æˆ°æƒ…å®¤ | Capital Flow Terminal</title>
</head>

<body>
    <div id="app" class="container">
        <!-- Header -->
        <header style="margin-bottom: 2rem; text-align: center;">
            <h1
                style="font-size: 2.5rem; margin-bottom: 0.5rem; background: linear-gradient(to right, #00C9FF, #92FE9D); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 20px rgba(0,201,255,0.3);">
                ğŸ§  V8 Sovereign Terminal</h1>
            <p style="color: var(--text-secondary); font-family: 'JetBrains Mono', monospace;">Autonomous Multi-Agent
                Hedge Fund System</p>
        </header>

        <!-- Real-time Status -->
        <div
            style="margin-bottom: 2rem; padding: 0.75rem 1rem; background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace;">
            <div style="display: flex; gap: 1.5rem; align-items: center;">
                <span :class="loading ? 'text-neutral' : 'text-green'">
                    â— ç³»çµ±ç‹€æ…‹: {{ loading ? 'åŒæ­¥ä¸­...' : 'å·²é€£ç·š' }}
                </span>
                <span v-if="data.meta">
                    ğŸ§  æ•¸æ“šç”Ÿæˆæ™‚é–“: {{ formatDate(data.meta.generated_at) }}
                </span>
            </div>
            <div>
                ğŸ”„ é é¢æœ€å¾ŒåŒæ­¥: {{ lastUpdated }}
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <div class="nav-tab" :class="{ active: currentTab === 'monitor' }" @click="currentTab = 'monitor'">
                âš¡ å³æ™‚æˆ°æƒ…å®¤ (Monitor)
            </div>
            <div class="nav-tab" :class="{ active: currentTab === 'analysis' }" @click="currentTab = 'analysis'">
                ğŸ“Š æ·±åº¦åˆ†æ (Analysis)
            </div>
            <a href="./trading_console.html" class="nav-tab"
                style="text-decoration: none; background: rgba(0, 255, 157, 0.1); color: #00ff9d; border: 1px solid #00ff9d;">
                ğŸ¤– é€²å…¥æ“ç›¤å®¤ (Trading Console)
            </a>
        </div>

        <!-- Loading State -->
        <div v-if="loading" class="loading">
            <span style="display: inline-block; animation: pulse 1.5s infinite;">ğŸ“¡</span> æ­£åœ¨å»ºç«‹åŠ å¯†æ•¸æ“šé€£ç·š...
        </div>

        <!-- Error State -->
        <div v-else-if="error" class="loading" style="color: var(--bearish);">
            âŒ æ•¸æ“šè¼‰å…¥å¤±æ•—: {{ error }}
        </div>

        <!-- Main Content -->
        <div v-else>

            <!-- TAB 1: MONITOR VIEW -->
            <div v-show="currentTab === 'monitor'">
                <!-- Market Weather Banner (AI Powered) -->
                <div :class="['weather-banner', weatherClass]"
                    style="margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between; padding: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <span style="font-size: 2.5rem;">{{ weatherIcon }}</span>
                        <div>
                            <div style="font-size: 1.2rem; font-weight: bold;">{{ data.market_overview?.sentiment?.label
                                }}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">
                                AI Score: {{ data.market_overview?.sentiment?.score }} | F&G: {{
                                data.market_overview?.sentiment?.factors?.find(f => f.name.includes('Sentiment'))?.value
                                || 'N/A' }}
                                <br v-if="data.macro_intelligence">
                                <span v-if="data.macro_intelligence" style="color: #00ffcc; font-weight: bold;">
                                    ğŸ§  V8 Macro: {{ data.macro_intelligence.regime }} (Bias: {{
                                    data.macro_intelligence.macro_bias > 0 ? '+' : '' }}{{
                                    data.macro_intelligence.macro_bias }})
                                </span>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; opacity: 0.7; max-width: 40%;"
                        class="hide-mobile">
                        <span>{{ weatherText }}</span>
                    </div>
                </div>

                <!-- Key Stats Cards (Monitor Style) -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div
                        style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.5rem;">4H è¶¨å‹¢
                            (Trend)</div>
                        <div class="font-mono" style="font-size: 1.2rem;"
                            :class="data.timeframes?.['4h']?.cex?.net_flow > 0 ? 'text-green' : 'text-red'">
                            {{ formatM(data.timeframes?.['4h']?.cex?.net_flow) }}M
                        </div>
                    </div>
                    <div
                        style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.5rem;">24H ç¸½é‡
                            (Volume)</div>
                        <div class="font-mono text-neutral" style="font-size: 1.2rem;">
                            ${{ formatB(data.market_overview?.total_tvl?.total) }}B
                        </div>
                    </div>
                    <!-- Derivatives Context (New) -->
                    <div
                        style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.5rem;">åˆç´„æƒ…ç·’
                            (Derivs)</div>
                        <div class="font-mono" style="font-size: 0.9rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span>è²»ç‡:</span>
                                <span
                                    :class="(data.market_overview?.derivatives?.funding_rates?.BTC || 0) > 0.01 ? 'text-green' : 'text-neutral'">
                                    {{ ((data.market_overview?.derivatives?.funding_rates?.BTC || 0) * 100).toFixed(4)
                                    }}%
                                </span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 2px;">
                                <span>OI (BTC):</span>
                                <span>{{ formatB(data.market_overview?.derivatives?.open_interest?.BTC) }} ğŸª™</span>
                            </div>
                        </div>
                    </div>
                    <!-- Smart Money (New) -->
                    <div
                        style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border: 1px solid var(--border);">
                        <div style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 0.5rem;">ä¸»åŠ›å‹•å‘
                            (Whale)</div>
                        <div class="font-mono" style="font-size: 1.2rem;"
                            :class="(data.market_overview?.smart_money?.stable_flow_24h || 0) > 0 ? 'text-green' : 'text-red'">
                            {{ formatM(data.market_overview?.smart_money?.stable_flow_24h) }}M
                        </div>
                    </div>
                </div>

                <!-- Alpha Hunter (V3) -->
                <div class="section" v-if="data.market_overview?.alpha_opportunities?.length > 0">
                    <div class="section-header">
                        <h2>âœ¨ AI ç²¾é¸æ©Ÿæœƒ (Alpha Hunter)</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        <div v-for="(opp, idx) in data.market_overview.alpha_opportunities.slice(0, 6)"
                            :key="'opp-'+idx"
                            style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; padding: 1rem; position: relative; overflow: hidden;">

                            <!-- Glowing Border Effect for High Score -->
                            <div v-if="opp.score >= 90"
                                style="position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--primary);">
                            </div>

                            <div
                                style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                <div>
                                    <div style="font-weight: bold; font-size: 1.1rem;">{{ opp.asset }}</div>
                                    <div style="font-size: 0.8rem; opacity: 0.8;">{{ translateTag(opp.type) }}</div>
                                </div>
                                <div class="badge"
                                    :class="opp.direction.includes('LONG') || opp.direction.includes('BUY') ? 'badge-bullish' : 'badge-bearish'"
                                    style="font-size: 0.9rem;">
                                    {{ opp.direction }}
                                </div>
                            </div>

                            <div style="font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--text-primary);">
                                {{ opp.reason }}
                            </div>

                            <div
                                style="background: rgba(0,0,0,0.2); padding: 0.5rem; border-radius: 4px; font-family: monospace; font-size: 0.8rem; color: var(--text-secondary);">
                                {{ opp.data }}
                            </div>

                            <!-- V4 Feature: Related Tokens -->
                            <div v-if="opp.related_tokens && opp.related_tokens.length > 0"
                                style="margin-top: 0.5rem; font-size: 0.8rem;">
                                <span style="color: var(--text-secondary);">ğŸ”¥ é—œæ³¨å¹£ç¨®:</span>
                                <div style="display: flex; gap: 4px; flex-wrap: wrap; margin-top: 4px;">
                                    <span v-for="token in opp.related_tokens"
                                        style="background: rgba(0, 255, 204, 0.1); color: var(--text-accent); padding: 2px 6px; border-radius: 4px; border: 1px solid rgba(0, 255, 204, 0.2);">
                                        {{ token }}
                                    </span>
                                </div>
                            </div>
                            <!-- V7 Hive Mind Analysis -->
                            <div v-if="opp.hive_analysis"
                                style="margin-top: 1rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 0.5rem;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <span style="font-size: 0.8rem; color: var(--text-secondary);">ğŸ§  Hive
                                        Consensus:</span>
                                    <span :style="{
                                        color: opp.hive_analysis.consensus_score > 0 ? '#00ff9d' : '#ff4d4d',
                                        fontWeight: 'bold',
                                        fontSize: '0.9rem'
                                    }">
                                        {{ opp.hive_analysis.verdict }} ({{ opp.hive_analysis.consensus_score }}%)
                                    </span>
                                </div>

                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div v-for="agent in opp.hive_analysis.debate_log" :key="agent.name"
                                        style="display: flex; gap: 0.5rem; align-items: flex-start; font-size: 0.75rem;">
                                        <div style="font-size: 1.2rem;" :title="agent.role">{{ agent.icon }}</div>
                                        <div
                                            style="background: rgba(255,255,255,0.05); padding: 4px 8px; border-radius: 8px; flex: 1;">
                                            <div
                                                style="font-weight: bold; color: var(--text-secondary); margin-bottom: 2px;">
                                                {{ agent.name }}</div>
                                            <div style="color: var(--text-primary); line-height: 1.2;">{{ agent.comment
                                                }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                style="position: absolute; bottom: 0.5rem; right: 0.5rem; font-size: 0.8rem; opacity: 0.5;">
                                AI Score: {{ opp.score }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Simple Monitor Table -->
                <div class="section">
                    <div class="section-header">
                        <h2>ğŸš€ é‡é»é—œæ³¨è³‡ç”¢ (Key Assets)</h2>
                    </div>
                    <table class="market-table">
                        <thead>
                            <tr>
                                <th>Asset (è³‡ç”¢)</th>
                                <th>4H Flow (4å°æ™‚)</th>
                                <th>24H Net (æ—¥æ·¨æµ)</th>
                                <th>Status (ç‹€æ…‹)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Top Checks (using existing CEX data logic) -->
                            <tr v-for="cex in sortedCex.slice(0, 5)" :key="'mon-'+cex.exchange">
                                <td data-label="Asset">
                                    <div class="token-cell">
                                        <span>{{ cex.exchange }}</span>
                                        <span v-if="cex.tags?.[0]" class="badge badge-whale">{{ cex.tags[0].type
                                            }}</span>
                                    </div>
                                </td>
                                <td data-label="4H Flow" class="font-mono"
                                    :class="cex.net_flow_4h > 0 ? 'text-green' : 'text-red'">
                                    {{ formatM(cex.net_flow_4h) }}M
                                </td>
                                <td data-label="24H Net" class="font-mono"
                                    :class="cex.net_flow_24h > 0 ? 'text-green' : 'text-red'">
                                    {{ formatM(cex.net_flow_24h) }}M
                                </td>
                                <td data-label="Status">
                                    <span v-if="cex.net_flow_4h > 0 && cex.net_flow_24h > 0"
                                        style="color: var(--bullish);">
                                        ğŸš€ å¼·å‹¢æµå…¥
                                    </span>
                                    <span v-else-if="cex.net_flow_4h < 0 && cex.net_flow_24h < 0"
                                        style="color: var(--bearish);">
                                        ğŸ“‰ æŒçºŒæµå‡º
                                    </span>
                                    <span v-else style="color: var(--text-secondary);">
                                        ğŸ”„ éœ‡ç›ªæ•´ç†
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- TAB 2: ANALYSIS VIEW (Original Content) -->
            <div v-show="currentTab === 'analysis'">
                <!-- 2. AI Market Weather -->
                <div :class="['weather-banner', weatherClass]">
                    <span style="font-size: 1.5rem;">{{ weatherIcon }}</span>
                    <span>{{ weatherText }}</span>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value text-neutral">${{ formatB(data.market_overview?.stablecoin_marketcap ||
                            data.stablecoin_marketcap) }}B</div>
                        <div class="stat-label">ç©©å®šå¹£ç¸½å¸‚å€¼ (Market Cap)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value"
                            :class="data.cex_flows?.summary?.total_stablecoin_flow_24h > 0 ? 'text-green' : 'text-red'">
                            ${{ formatM(data.cex_flows?.summary?.total_stablecoin_flow_24h) }}M
                        </div>
                        <div class="stat-label">CEX 24H ç©©å®šå¹£æ·¨æµå‘</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value"
                            :class="data.cex_flows?.summary?.total_btc_eth_flow_24h > 0 ? 'text-red' : 'text-green'">
                            ${{ formatM(data.cex_flows?.summary?.total_btc_eth_flow_24h) }}M
                        </div>
                        <div class="stat-label">CEX 24H BTC/ETH æ·¨æµå‘</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value text-neutral">{{ formatTime(data.meta?.execution_time_seconds ||
                            data.execution_time_seconds) }}s</div>
                        <div class="stat-label">ä¸Šæ¬¡æ›´æ–°: {{ formatDate(data.meta?.generated_at || data.generated_at) }}
                        </div>
                    </div>
                </div>

                <!-- Chain Flows Table -->
                <div class="section">
                    <div class="section-header">
                        <h2>ğŸ”— å…¬éˆè³‡é‡‘æµå‘ (Chain Flows)</h2>
                        <span style="font-size: 0.8rem; color: var(--text-secondary);">é¡¯ç¤ºå‰ 10 å¤§ TVL å…¬éˆ</span>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>å…¬éˆåç¨±</th>
                                    <th @click="sortBy('tvl_total', 'chain')" class="sortable"
                                        :class="{active: chainSortKey === 'tvl_total'}">
                                        <span class="has-tooltip"
                                            data-tooltip="ç¸½é–å€‰é‡ (Total Value Locked)ã€‚&#10;ä»£è¡¨è©²æ¢å€å¡Šéˆä¸Šæ‰€æœ‰ DeFi å”è­°ä¸­é–å®šçš„è³‡é‡‘ç¸½å’Œã€‚&#10;ğŸ’¡ TVL è¶Šé«˜ï¼Œä»£è¡¨è©²ç”Ÿæ…‹è¶Šç¹æ¦®ã€è³‡é‡‘æ²‰æ¾±è¶Šå¤šã€‚">TVL</span>
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th @click="sortBy('change_24h_pct', 'chain')" class="sortable"
                                        :class="{active: chainSortKey === 'change_24h_pct'}">
                                        24H è®Šå‹• <span class="sort-icon">â†•</span>
                                    </th>
                                    <th @click="sortBy('stable_inflow_24h', 'chain')" class="sortable"
                                        :class="{active: chainSortKey === 'stable_inflow_24h'}">
                                        <span class="has-tooltip"
                                            data-tooltip="ç©©å®šå¹£ (USDT/USDC) 24å°æ™‚æ·¨æµå…¥é‡ã€‚&#10;ğŸ’¡ é€™æ˜¯å¸‚å ´çš„ã€ä¹¾ç«è—¥ã€(Buying Power)ã€‚&#10;ğŸŸ¢ æ­£å€¼: è³‡é‡‘é€²å ´ï¼Œé€šå¸¸æ˜¯æˆ‘å€‘é€²å ´åšå¤šçš„ä¿¡è™Ÿã€‚&#10;ğŸ”´ è² å€¼: è³‡é‡‘æ’¤é€€ï¼Œå¯èƒ½ä»£è¡¨ä¸»åŠ›æ­£åœ¨ç²åˆ©äº†çµã€‚">ç©©å®šå¹£æµå…¥</span>
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th style="text-align: left;">AI æ™ºèƒ½æ¨™ç±¤</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="chain in sortedChains" :key="chain.chain">
                                    <td :data-label="'å…¬éˆåç¨±'">{{ chain.chain }}</td>
                                    <td data-label="TVL" class="text-neutral">${{ formatB(chain.tvl_total) }}B</td>
                                    <td data-label="24H è®Šå‹•"
                                        :class="chain.change_24h_pct >= 0 ? 'text-green' : 'text-red'">
                                        {{ chain.change_24h_pct >= 0 ? '+' : '' }}{{ chain.change_24h_pct }}%
                                    </td>
                                    <td data-label="ç©©å®šå¹£æµå…¥ (Buying Power)"
                                        :class="chain.stable_inflow_24h >= 0 ? 'text-green' : 'text-red'">
                                        ${{ formatM(chain.stable_inflow_24h) }}M
                                    </td>
                                    <td data-label="AI æ™ºèƒ½æ¨™ç±¤" style="text-align: left;">
                                        <span v-for="tag in chain.tags" :key="tag.type" class="tag"
                                            :class="getTagClass(tag.signal)">
                                            {{ translateTag(tag.type) }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- CEX Flows Table -->
                <div class="section">
                    <div class="section-header">
                        <h2>ğŸ¦ äº¤æ˜“æ‰€è³‡é‡‘æµå‘ (CEX Flows)</h2>
                        <span style="font-size: 0.8rem; color: var(--text-secondary);">ç›£æ¸¬ç©©å®šå¹£èˆ‡é¢¨éšªè³‡ç”¢çš„é€²å‡º</span>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>äº¤æ˜“æ‰€</th>
                                    <th @click="sortBy('net_flow_24h', 'cex')" class="sortable"
                                        :class="{active: cexSortKey === 'net_flow_24h'}">
                                        ç¸½æ·¨æµå‘ (24H) <span class="sort-icon">â†•</span>
                                    </th>
                                    <th @click="sortBy('net_flow_4h', 'cex')" class="sortable"
                                        :class="{active: cexSortKey === 'net_flow_4h'}">
                                        æ·¨æµå‘ (4H) <span class="sort-icon">â†•</span>
                                    </th>
                                    <th @click="sortBy('stablecoin_flow_24h', 'cex')" class="sortable"
                                        :class="{active: cexSortKey === 'stablecoin_flow_24h'}">
                                        <span class="has-tooltip"
                                            data-tooltip="ç©©å®šå¹£ (USDT/USDC) 24å°æ™‚æ·¨æµå…¥é‡ã€‚&#10;ğŸŸ¢ æ­£å€¼: è³‡é‡‘é€²å…¥äº¤æ˜“æ‰€ (æ½›åœ¨è²·ç›¤)ã€‚&#10;ğŸ”´ è² å€¼: è³‡é‡‘æç¾é›¢å ´ (è³¼è²·åŠ›ä¸‹é™)ã€‚">ç©©å®šå¹£</span>
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th @click="sortBy('btc_eth_flow_24h', 'cex')" class="sortable"
                                        :class="{active: cexSortKey === 'btc_eth_flow_24h'}">
                                        <span class="has-tooltip"
                                            data-tooltip="BTC/ETH ç­‰é¢¨éšªè³‡ç”¢ 24å°æ™‚æ·¨æµå…¥é‡ã€‚&#10;ğŸ”´ æ­£å€¼: å¤§æˆ¶è½‰å…¥äº¤æ˜“æ‰€ (æ½›åœ¨è³£å£“)ã€‚&#10;ğŸŸ¢ è² å€¼: å¤§æˆ¶æå¹£å›¤è²¨ (æ¸›å°‘æµé€š)ã€‚">BTC/ETH</span>
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="cex in sortedCex" :key="cex.exchange">
                                    <td data-label="äº¤æ˜“æ‰€">
                                        <div class="token-cell">
                                            <span>{{ cex.exchange }}</span>
                                            <span v-if="cex.tags && cex.tags.length" class="badge badge-whale"
                                                :class="getTagClass(cex.tags[0].signal)">{{
                                                translateTag(cex.tags[0].type) }}</span>
                                        </div>
                                    </td>
                                    <td data-label="ç¸½æ·¨æµå‘ (24H)" class="font-mono"
                                        :class="cex.net_flow_24h >= 0 ? 'text-green' : 'text-red'">
                                        ${{ formatM(cex.net_flow_24h) }}M
                                    </td>
                                    <td data-label="æ·¨æµå‘ (4H)" class="font-mono"
                                        :class="cex.net_flow_4h >= 0 ? 'text-green' : 'text-red'">
                                        ${{ formatM(cex.net_flow_4h) }}M
                                    </td>
                                    <td data-label="ç©©å®šå¹£" class="font-mono"
                                        :class="cex.stablecoin_flow_24h >= 0 ? 'text-green' : 'text-red'">
                                        ${{ formatM(cex.stablecoin_flow_24h) }}M
                                    </td>
                                    <td data-label="BTC/ETH" class="font-mono"
                                        :class="cex.btc_eth_flow_24h >= 0 ? 'text-red' : 'text-green'">
                                        ${{ formatM(cex.btc_eth_flow_24h) }}M
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 5. Quant Zone -->
                <div class="quant-zone">
                    <h3 style="color: var(--text-secondary); font-size: 1rem;">ğŸ‘¨â€ğŸ’» é‡åŒ–åˆ†æå°ˆå€ (Quant Zone)</h3>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">æ­¤æ•¸æ“šæ ¼å¼å°ˆç‚ºé‡åŒ–åˆ†ææ¨¡å‹
                        (Quantitative Models) å„ªåŒ–ï¼ŒåŒ…å«å®Œæ•´çš„è³‡é‡‘æ­¸å› æ¨™ç±¤èˆ‡æ­·å²æµå‘ç´€éŒ„ã€‚</p>
                    <div class="btn-group">
                        <a href="./data.json" class="btn btn-primary" download>
                            <span>ğŸ“¥</span> åŒ¯å‡ºåŸå§‹æ•¸æ“š (JSON) | API å°ˆç”¨
                        </a>
                        <a href="./history.csv" class="btn" download>
                            <span>ğŸ“Š</span> ä¸‹è¼‰å›æ¸¬æ•¸æ“š (CSV) | é‡åŒ–å°ˆç”¨
                        </a>
                    </div>
                </div>

                <!-- 6. Methodology Footer -->
                <div class="footer">
                    <div class="method-box">
                        <strong>ğŸ“– åˆ†ææ–¹æ³•è«– (Methodology & Definitions)</strong>
                        <div class="method-grid">
                            <div class="method-item">
                                <h4>ğŸ§® çµ±è¨ˆé€±æœŸèˆ‡è¨ˆç®— (Calculation & Period)</h4>
                                <p>
                                    <strong>â€¢ çµ±è¨ˆé€±æœŸ:</strong> æ¡ç”¨éå» 24 å°æ™‚æ»¾å‹•çª—å£ (Rolling 24H)ã€‚<br>
                                    <strong>â€¢ æ›´æ–°é »ç‡:</strong> æ¯ 30 åˆ†é˜è‡ªå‹•åŒæ­¥éˆä¸Šæ•¸æ“šã€‚<br>
                                    <strong>â€¢ æ·¨æµå‘:</strong> è©²é€±æœŸå…§ [å……å€¼ç¸½é¡ - æç¾ç¸½é¡]ã€‚
                                </p>
                            </div>
                            <div class="method-item">
                                <h4>ğŸ’ª ä¸»åŠ›å¸ç±Œ (Buying Power)</h4>
                                <p>å®šç¾©ç‚ºç©©å®šå¹£ (USDT/USDC/DAI) æ·¨æµå…¥å–®ä¸€å¯¦é«” > $50M USDã€‚é€™é€šå¸¸ä»£è¡¨ä¸»åŠ›è³‡é‡‘å·²é€²å…¥å¸‚å ´ï¼Œæ­£åœ¨ç­‰å¾…æ©Ÿæœƒè²·å…¥ã€‚</p>
                            </div>
                            <div class="method-item">
                                <h4>âš ï¸ å€’è²¨é¢¨éšª (Dump Risk)</h4>
                                <p>å®šç¾©ç‚ºæ³¢å‹•æ€§è³‡ç”¢ (BTC/ETH) æ·¨æµå…¥äº¤æ˜“æ‰€ > $100M USDã€‚é€™ä»£è¡¨å¤§æˆ¶å°‡å†·éŒ¢åŒ…è³‡ç”¢è½‰ç§»è‡³äº¤æ˜“æ‰€ï¼Œå­˜åœ¨æ½›åœ¨æ‹‹å”®å£“åŠ›ã€‚</p>
                            </div>
                            <div class="method-item">
                                <h4>ğŸ“¡ æ•¸æ“šä¾†æº (Data Source)</h4>
                                <p>èšåˆ DefiLlama Protocol API èˆ‡å¤šéˆ RPC ç¯€é»æ•¸æ“šã€‚æˆ‘å€‘å·²ç®—æ³•å‰”é™¤äº¤æ˜“æ‰€å…§éƒ¨éŒ¢åŒ…è½‰å¸³çš„é›œè¨Šï¼Œä»¥åæ˜ çœŸå¯¦çš„è³‡é‡‘æµå‹•ã€‚</p>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <p>Powered by DefiLlama & Chain RPCs | Build v3.1 | Data updates every 30 mins</p>
                    </div>
                </div>
            </div> <!-- End v-show="analysis" -->
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentTab: 'monitor',
                    data: {},
                    loading: true,
                    error: null,
                    paperTrades: { positions: [], summary: { total_unrealized_pnl: 0 } },
                    lastUpdated: '-',
                    chainSortKey: 'stable_inflow_24h',
                    chainSortOrder: -1, // -1 for descending
                    cexSortKey: 'stablecoin_flow_24h',
                    cexSortOrder: -1
                }
            },
            computed: {
                weatherClass() {
                    const sentiment = this.data.market_sentiment || '';
                    if (sentiment.includes('Bullish')) return 'weather-bullish';
                    if (sentiment.includes('Bearish')) return 'weather-bearish';
                    return 'weather-neutral';
                },
                weatherIcon() {
                    if (this.weatherClass === 'weather-bullish') return 'ğŸŒ¤ï¸';
                    if (this.weatherClass === 'weather-bearish') return 'ğŸŒ§ï¸';
                    return 'â˜ï¸';
                },
                weatherText() {
                    if (this.weatherClass === 'weather-bullish')
                        return "å¸‚å ´æ™´æœ— (çœ‹å¤š) | è³‡é‡‘å¼·åŠ›é€²å ´ï¼Œä¸»åŠ›æ­£åœ¨ç´¯ç©ç±Œç¢¼ (USDT æµå…¥)ã€‚";
                    if (this.weatherClass === 'weather-bearish')
                        return "å¸‚å ´é™°é›¨ (çœ‹ç©º) | è³‡é‡‘æ­£åœ¨æ’¤é€€æˆ–è½‰ç§»è‡³äº¤æ˜“æ‰€ï¼Œæ³¨æ„å€’è²¨é¢¨éšªã€‚";
                    return "å¸‚å ´å¤šé›² (ç›¤æ•´) | è³‡é‡‘æµå‘ä¸æ˜é¡¯ï¼Œè§€æœ›æ°£æ°›æ¿ƒåšã€‚";
                },
                sortedChains() {
                    const chains = this.data.dex_analysis?.chains || this.data.chain_flows?.chains || [];
                    return [...chains].sort((a, b) => {
                        const aVal = a[this.chainSortKey] || 0;
                        const bVal = b[this.chainSortKey] || 0;
                        return (aVal - bVal) * this.chainSortOrder;
                    });
                },
                sortedCex() {
                    const exchanges = this.data.cex_analysis?.exchanges || this.data.cex_flows?.exchanges || [];
                    return [...exchanges].sort((a, b) => {
                        const aVal = a[this.cexSortKey] || 0;
                        const bVal = b[this.cexSortKey] || 0;
                        return (aVal - bVal) * this.cexSortOrder;
                    });
                }
            },
            methods: {
                // 4. Content Localization
                translateTag(tag) {
                    const map = {
                        "Buying Power": "ğŸ’ª ä¸»åŠ›å¸ç±Œ (è³¼è²·åŠ›)",
                        "Dump Risk": "âš ï¸ å€’è²¨é¢¨éšª (è³£å£“)",
                        "Capital Flight": "ğŸ’¸ è³‡é‡‘å¤–é€ƒ",
                        "Accumulation": "ğŸ“¥ ç´¯ç©ç±Œç¢¼",
                        "Withdrawal": "ğŸ”’ æå¹£å›¤è²¨",
                        "Strong Momentum": "ğŸš€ å‹•èƒ½å¼·å‹",
                        "Asset Rotation": "ğŸ”„ è³‡ç”¢è¼ªå‹•",
                        "Neutral": "â– ä¸­æ€§"
                    };
                    // Simple fuzzy matching for V3 tags
                    if (tag === 'CHAIN') return 'ğŸ”— å…¬éˆ';
                    if (tag === 'CEX') return 'ğŸ¦ äº¤æ˜“æ‰€';
                    if (tag.includes('Stablecoin Outflow')) return 'ğŸ’¸ ç©©å®šå¹£æµå‡º';
                    if (tag.includes('Short-term Outflow')) return 'ğŸ“‰ çŸ­æœŸæµå‡º';
                    if (tag.includes('Trend Confirmed')) return 'âœ… è¶¨å‹¢ç¢ºèª';
                    if (tag.includes('Trend Divergence')) return 'âš ï¸ è¶¨å‹¢èƒŒé›¢';
                    if (tag === 'Stable') return 'âš“ ç©©å®š';

                    return map[tag] || tag;
                },
                sortBy(key, tableType) {
                    if (tableType === 'chain') {
                        if (this.chainSortKey === key) {
                            this.chainSortOrder *= -1; // toggle
                        } else {
                            this.chainSortKey = key;
                            this.chainSortOrder = -1; // default desc
                        }
                    } else {
                        if (this.cexSortKey === key) {
                            this.cexSortOrder *= -1;
                        } else {
                            this.cexSortKey = key;
                            this.cexSortOrder = -1;
                        }
                    }
                },
                formatB(num) {
                    return num ? (num / 1e9).toFixed(2) : '0.00';
                },
                formatM(num) {
                    return num ? (num / 1e6).toFixed(1) : '0.0';
                },
                formatTime(sec) {
                    return sec ? sec.toFixed(2) : '0.00';
                },
                formatDate(str) {
                    if (!str) return '-';
                    try {
                        return new Date(str).toLocaleString('zh-TW', {
                            hour12: false,
                            timeZone: 'Asia/Taipei',
                            year: 'numeric', month: '2-digit', day: '2-digit',
                            hour: '2-digit', minute: '2-digit', second: '2-digit'
                        }) + ' (å°ç£æ™‚é–“)';
                    } catch (e) {
                        return str;
                    }
                },
                getTagClass(signal) {
                    if (signal === 'Bullish') return 'tag-bullish';
                    if (signal === 'Bearish') return 'tag-bearish';
                    return 'tag-neutral';
                },
                async fetchData() {
                    try {
                        // Anti-cache param
                        const response = await fetch(`./data.json?t=${new Date().getTime()}`);
                        if (!response.ok) throw new Error('ç„¡æ³•è¼‰å…¥ data.json');
                        this.data = await response.json();

                        // Fetch Paper Trades
                        try {
                            const paperRes = await fetch(`./paper_trades.json?t=${new Date().getTime()}`);
                            if (paperRes.ok) {
                                let tradesData = await paperRes.json();
                                // Calculate summary stats locally if not present
                                let totalPnL = 0;
                                if (tradesData.length > 0) {
                                    totalPnL = tradesData.reduce((acc, pos) => acc + (pos.pnl_usd || 0), 0);
                                }
                                this.paperTrades = {
                                    positions: activePositions = tradesData.filter(p => p.status === 'OPEN'),
                                    summary: { total_unrealized_pnl: totalPnL }
                                };
                            }
                        } catch (e) {
                            console.warn("Paper trades fetch failed", e);
                        }

                    } catch (e) {
                        this.error = e.message;
                    } finally {
                        this.loading = false;
                        this.lastUpdated = new Date().toLocaleString('zh-TW', { timeZone: 'Asia/Taipei', hour12: false });
                    }
                }
            },
            mounted() {
                // Check tab param
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('tab') === 'monitor') {
                    this.currentTab = 'monitor';
                }

                this.fetchData();
                // Auto refresh every 30s for more "live" feel
                setInterval(() => this.fetchData(), 30 * 1000);
            }
        }).mount('#app');
    </script>
</body>

</html>